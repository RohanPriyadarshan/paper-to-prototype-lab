# Model Configuration
# CropHealth AI - ML Training Parameters
# Authors: Rohan Priyadarshan & Saket Kumawat

# ===========================================
# DATA CONFIGURATION
# ===========================================
data:
  raw_path: "data/raw"
  processed_path: "data/processed"
  augmented_path: "data/augmented"
  
  split_ratios:
    train: 0.70
    validation: 0.15
    test: 0.15
  
  num_classes: 38
  
  # ImageNet normalization constants
  normalization:
    mean: [0.485, 0.456, 0.406]
    std: [0.229, 0.224, 0.225]

# ===========================================
# PREPROCESSING CONFIGURATION
# ===========================================
preprocessing:
  target_size_small: 224   # ResNet50, DenseNet121, ViT
  target_size_large: 299   # InceptionV3
  min_resolution: 224
  
  augmentation:
    horizontal_flip: 0.5
    vertical_flip: 0.3
    rotation_limit: 20
    brightness_limit: 0.2
    contrast_limit: 0.2
    blur_limit: 3

# ===========================================
# MODEL CONFIGURATIONS
# ===========================================
models:
  resnet50:
    architecture: "ResNet50"
    input_size: 224
    base_weights: "imagenet"
    dense_units: 512
    dropout_rate: 0.5
    l2_regularization: 0.0001
    
  densenet121:
    architecture: "DenseNet121"
    input_size: 224
    base_weights: "imagenet"
    dense_units: 512
    dropout_rate: 0.5
    l2_regularization: 0.0001
    
  inceptionv3:
    architecture: "InceptionV3"
    input_size: 299
    base_weights: "imagenet"
    dense_units: 512
    dropout_rate: 0.5
    l2_regularization: 0.0001
    
  vit:
    architecture: "ViT-B/16"
    input_size: 224
    base_weights: "imagenet21k"
    dense_units: 512
    dropout_rate: 0.5
    l2_regularization: 0.0001

# ===========================================
# TRAINING CONFIGURATION
# ===========================================
training:
  batch_size: 32
  epochs: 50
  fine_tune_epochs: 20
  
  optimizer:
    name: "adam"
    initial_learning_rate: 0.0001
    fine_tune_learning_rate: 0.00005
    
  callbacks:
    early_stopping:
      patience: 10
      restore_best_weights: true
      monitor: "val_loss"
    
    reduce_lr:
      factor: 0.5
      patience: 5
      min_lr: 0.000001
    
    model_checkpoint:
      save_best_only: true
      monitor: "val_accuracy"
  
  # Fine-tuning: unfreeze last N layers
  fine_tune_layers: 30
  
  # Class weights for imbalanced data
  use_class_weights: true

# ===========================================
# ENSEMBLE CONFIGURATION
# ===========================================
ensemble:
  models:
    - name: "resnet50"
      weight: 0.30
    - name: "densenet121"
      weight: 0.35
    - name: "inceptionv3"
      weight: 0.15
    - name: "vit"
      weight: 0.20
  
  voting_strategy: "weighted_average"
  confidence_threshold: 0.5
  top_k_predictions: 5

# ===========================================
# INFERENCE CONFIGURATION
# ===========================================
inference:
  batch_size: 1
  use_gpu: true
  model_path: "models/saved"
  tflite_path: "models/tflite"
  
  # GradCAM visualization
  gradcam:
    enabled: true
    layer_name: "conv5_block3_out"  # For ResNet50
    colormap: "jet"
    alpha: 0.4

# ===========================================
# EXPORT CONFIGURATION
# ===========================================
export:
  tflite:
    quantization: "float16"
    optimize: true
  
  onnx:
    opset_version: 13
